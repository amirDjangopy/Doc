# مستندات API بخش مدیریت کاربران

## معرفی کلی

این سرویس وظیفه مدیریت کاربران را برعهده دارد، شامل ثبت‌نام، احراز هویت، مشاهده و ویرایش پروفایل، و حذف کاربران.  
سرویس با استفاده از Django REST Framework و JWT برای احراز هویت پیاده‌سازی شده است.

---

## تکنولوژی‌ها

- **زبان برنامه‌نویسی:** Python 3.12  
- **فریم‌ورک:** Django 5.2  
- **API:** Django REST Framework (DRF)  
- **احراز هویت:** JWT (توکن‌های وب JSON)  
- **پایگاه داده:** PostgreSQL در محیط پروداکشن، SQLite برای توسعه  
- **مدیریت تنظیمات:** استفاده از فایل `.env` و python-decouple

---

## مسیرهای API

| مسیر                      | متد  | توضیح                         | نیازمندی احراز هویت   | دسترسی‌ها             |
|---------------------------|-------|------------------------------|----------------------|----------------------|
| `/api/v1/users/`           | GET   | دریافت لیست کاربران           | توکن JWT الزامی       | فقط مدیران (Admin)   |
| `/api/v1/users/`           | POST  | ثبت‌نام کاربر جدید            | بدون نیاز به توکن     | عمومی (Public)       |
| `/api/v1/users/{id}/`      | GET   | دریافت اطلاعات کاربر مشخص     | توکن JWT الزامی       | صاحب حساب یا مدیر     |
| `/api/v1/users/{id}/`      | PUT   | ویرایش پروفایل کاربر          | توکن JWT الزامی       | صاحب حساب یا مدیر     |
| `/api/v1/users/{id}/`      | DELETE| حذف کاربر                    | توکن JWT الزامی       | فقط مدیران           |
| `/api/v1/auth/login/`      | POST  | ورود کاربر (لاگین)            | بدون نیاز به توکن     | عمومی                |
| `/api/v1/auth/logout/`     | POST  | خروج کاربر (لاگ‌اوت)           | توکن JWT الزامی       | کاربران احراز شده    |

---

## قالب درخواست و پاسخ‌ها

### ثبت‌نام کاربر (POST `/api/v1/users/`)

**بدنه درخواست (JSON):**
```json
{
  "username": "string",
  "email": "string",
  "password": "string"
}
username: اجباری، یکتا، بین 3 تا 150 کاراکتر

email: اجباری، با فرمت ایمیل معتبر

password: اجباری، حداقل 8 کاراکتر، رمز عبور به صورت هش شده ذخیره می‌شود

پاسخ موفق (۲۰۱ Created):

json
Copy
Edit
{
  "id": عدد صحیح,
  "username": "string",
  "email": "string",
  "date_joined": "تاریخ و زمان به فرمت ISO8601"
}
ورود به سیستم (POST /api/v1/auth/login/)
بدنه درخواست:

json
Copy
Edit
{
  "username": "string",
  "password": "string"
}
پاسخ موفق (۲۰۰ OK):

json
Copy
Edit
{
  "access": "توکن دسترسی JWT",
  "refresh": "توکن تجدید JWT"
}
احراز هویت و مجوزها
از JWT برای امنیت استفاده شده است.

مسیرهای محافظت شده نیاز به هدر Authorization: Bearer <access_token> دارند.

مجوزها با استفاده از دسترسی‌های DRF مانند IsAuthenticated و مجوزهای سفارشی برای مالکیت و دسترسی مدیر کنترل می‌شوند.

اعتبارسنجی و امنیت
رمز عبورها با استفاده از مکانیزم هش داخلی جنگو (make_password()) و الگوریتم PBKDF2 ذخیره می‌شوند.

تکراری نبودن ایمیل و نام کاربری در سطح پایگاه داده و اعتبارسنجی انجام می‌شود.

محدودیت نرخ درخواست (Rate Limiting) روی لاگین برای جلوگیری از حملات بروت‌فورس اعمال شده است.

در محیط پروداکشن، تمام ترافیک API باید با HTTPS ارسال شود.

مدل‌های پایگاه داده (خلاصه)
python
Copy
Edit
class User(AbstractUser):
    email = models.EmailField(unique=True)
    # فیلدهای اضافی در صورت نیاز قابل اضافه هستند
مدیریت خطا
کدهای استاندارد HTTP (۴۰۰، ۴۰۱، ۴۰۳، ۴۰۴، ۵۰۰) در پاسخ‌ها بازگردانده می‌شود.

قالب پاسخ خطا:

json
Copy
Edit
{
  "detail": "توضیح خطا"
}
نکات مربوط به استقرار
تنظیمات محیطی در فایل .env نگهداری می‌شود (مانند DEBUG، DATABASE_URL، ALLOWED_HOSTS، SECRET_KEY).

اتصال به پایگاه داده از طریق متغیرهای محیطی تنظیم می‌شود.

در پروداکشن باید DEBUG=False تنظیم شود و ALLOWED_HOSTS به درستی مقداردهی گردد.

برنامه‌های آتی
پیاده‌سازی بازیابی رمز عبور از طریق ایمیل

اضافه کردن احراز هویت دو مرحله‌ای (2FA)

ادغام ورود از طریق شبکه‌های اجتماعی (Google, Facebook)

لاگ‌برداری و ردیابی فعالیت کاربران

go
Copy
Edit

اگر می‌خواهی فایل `.md` آماده‌شده رو بفرستم، بگو تا ذخیره کنم و بفرستم.
